<div class="card">
    <p-table #dt [value]="products" [paginator]="true" [rows]="rows" 
        [tableStyle]="{ 'min-width': '50rem' }" [rowsPerPageOptions]="[5, 10, 20, 30]" 
        [sortMode]="'multiple'" [customSort]="true" (sortFunction)="customSort($event)">
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="id" style="width:15%">
                    Id
                    <p-sortIcon field="id"></p-sortIcon>
                </th>
                <th pSortableColumn="status" style="width:20%"
                >
                    Status
                    <p-sortIcon field="status"></p-sortIcon>
                </th>
                <th pSortableColumn="name" style="width:20%">
                    Name
                    <p-sortIcon field="name"></p-sortIcon>
                </th>
                <th pSortableColumn="price" style="width:20%">
                    Price
                    <p-sortIcon field="price"></p-sortIcon>
                </th>
                <th pSortableColumn="stock" style="width:20%">
                    Stock
                    <p-sortIcon field="stock"></p-sortIcon>
                </th>
                <th style="width: 5%;">  <!-- Reset Sort Button -->
                    <p-button label="" icon="pi pi-refresh" (click)="resetSort(dt)" class="reset-sort-button"></p-button>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-product>
            <tr class="editable-row" (click)="onRowClick($event, product)">
                <td>{{ product.id }}</td>
                <td>
                    <p [ngClass]="['label-like', getSeverity(product.status)]" >
                        {{product.status || 'not-selected'}}
                    </p>
                </td>
                <td>{{ product.name }}</td>
                <td>{{ product.price }}</td>
                <td>{{ product.stock }}</td>
                <td class="text-center">
                    
                    <p-button 
                        icon="pi pi-pencil" 
                        *ngIf="!isEditing"
                        class="mr-2 edit-btn" 
                        [rounded]="true" 
                        [outlined]="true" 
                        severity="success" 
                        (onClick)="editProduct(product)" />
                </td>

            </tr>
        </ng-template>
    </p-table>
</div>



<!-- Product card for row details -->
<div class="modal" *ngIf="selectedProduct" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <!-- Edit Button -->
        <p-button 
        icon="pi pi-pencil"
        *ngIf="!isEditing" 
        class="edit-bnt" 
        [rounded]="true" 
        [outlined]="true" 
        severity="success" 
        (onClick)="toggleEditMode()" />

        <h2>Product Details</h2>

        <!-- Product Fields -->
        <div class="product-field">
            <strong>Id:</strong>
            <span>{{ selectedProduct.id }}</span>
        </div>

        <div class="product-field">
            <strong>Name:</strong>
            <input *ngIf="isEditing" [(ngModel)]="selectedProduct.name" class="input-field" />
            <span *ngIf="!isEditing">{{ selectedProduct.name }}</span>
        </div>

        <div class="product-field">
            <strong>Price:</strong>
            <input *ngIf="isEditing" [(ngModel)]="selectedProduct.price" class="input-field" />
            <span *ngIf="!isEditing">{{ selectedProduct.price }}</span>
        </div>

        <div class="product-field">
            <strong>Stock:</strong>
            <input *ngIf="isEditing" [(ngModel)]="selectedProduct.stock" class="input-field" />
            <span *ngIf="!isEditing">{{ selectedProduct.stock }}</span>
        </div>

        <div class="product-field">
            <strong>Status:</strong>
            <select *ngIf="isEditing" [(ngModel)]="selectedProduct.status" class="select-field">
                <option value="in-stock">In Stock</option>
                <option value="low-stock">Low Stock</option>
                <option value="out-of-stock">Out of Stock</option>
            </select>
            <span *ngIf="!isEditing" [ngClass]="['label-like', getSeverity(selectedProduct.status)]">
                {{ selectedProduct.status || 'Not Selected' }}
            </span>
        </div>

        <!-- Save Button -->
        <button *ngIf="isEditing" (click)="saveChanges()" class="save-button">Save</button>

        <!-- Close Modal -->
        <button class="close-button" (click)="closeModal()">Close</button>
    </div>
</div>
